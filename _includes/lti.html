<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="951px" viewBox="-0.5 -0.5 951 296" content="&lt;mxfile modified=&quot;2020-03-11T15:38:02.986Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:73.0) Gecko/20100101 Firefox/73.0&quot; etag=&quot;ujmsjLWnYkvy9XVU7AlX&quot; version=&quot;12.8.2&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;NEN49luqhqemV9Vau6yv&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" onclick="(function(svg){var src=window.event.target||window.event.srcElement;while (src!=null&amp;&amp;src.nodeName.toLowerCase()!='a'){src=src.parentNode;}if(src==null){if(svg.wnd!=null&amp;&amp;!svg.wnd.closed){svg.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&amp;&amp;evt.source==svg.wnd){svg.wnd.postMessage(decodeURIComponent(svg.getAttribute('content')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);svg.wnd=window.open('https://www.draw.io/?client=1&amp;lightbox=1&amp;edit=_blank');}}})(this);" style="cursor:pointer;max-width:100%;max-height:296px;"><defs/><g><path d="M 298 290 L 297.5 90" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 195 294 L 194.5 89" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 490 290 L 490 90" fill="none" stroke="#b3b3b3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 20 108.5 L 183.64 113.79" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 188.88 113.96 L 181.77 117.24 L 183.64 113.79 L 182 110.24 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 112px; margin-left: 92px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">select task</div></div></div></foreignObject><text x="92" y="115" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">select task</text></switch></g><ellipse cx="192" cy="41.5" rx="37.5" ry="37.5" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 42px; margin-left: 156px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div align="center"><b>LTI Consumer<br /></b></div><div align="center"><b>(EDx, ...)</b><br /></div></div></div></div></foreignObject><text x="192" y="45" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">LTI Consumer...</text></switch></g><ellipse cx="487.5" cy="37.5" rx="37.5" ry="37.5" fill="#ffffff" stroke="#858585" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 73px; height: 1px; padding-top: 38px; margin-left: 452px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div style="text-align: center"><span>Algorea </span><span>Backend</span></div></div></div></div></foreignObject><text x="452" y="41" fill="#000000" font-family="Helvetica" font-size="12px" font-weight="bold">Algorea Back...</text></switch></g><path d="M 637 290 L 637 85" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="637.5" cy="37.5" rx="37.5" ry="37.5" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 73px; height: 1px; padding-top: 38px; margin-left: 602px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div style="text-align: center">Login Module</div></div></div></div></foreignObject><text x="602" y="41" fill="#000000" font-family="Helvetica" font-size="12px" font-weight="bold">Login Module</text></switch></g><ellipse cx="16.5" cy="27.13" rx="8.25" ry="8.125" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 16.5 35.25 L 16.5 62.33 M 16.5 40.67 L 0 40.67 M 16.5 40.67 L 33 40.67 M 16.5 62.33 L 0 84 M 16.5 62.33 L 33 84" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 16 294 L 16 94" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 20 160 L 191.68 162.81 C 191.74 158.91 197.74 159.01 197.68 162.91 L 197.68 162.91 L 294.69 164.5 C 294.75 160.6 300.75 160.7 300.69 164.6 L 300.69 164.6 L 487 167.66 C 487.06 163.76 493.06 163.85 493 167.75 L 493 167.75 L 623.63 169.9" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 628.88 169.98 L 621.83 173.37 L 623.63 169.9 L 621.94 166.37 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 160px; margin-left: 347px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "><div>POST /lti/launch?redirect_to=&lt;frontendurl&gt; + all lti parameters (+ login-module cookie)<br /></div></div></div></div></foreignObject><text x="347" y="164" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">POST /lti/launch?redirect_to=&lt;frontendurl&gt; + all lti parameters (+ login-module cookie)&#xa;</text></switch></g><path d="M 190 134 L 26.36 139.78" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 21.12 139.96 L 27.99 136.22 L 26.36 139.78 L 28.24 143.21 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 131px; margin-left: 102px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "><div>iframe to &lt;cfr next request&gt;<br /></div></div></div></div></foreignObject><text x="102" y="134" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">iframe to &lt;cfr next request&gt;&#xa;</text></switch></g><path d="M 620 180 L 493 182.12 M 487 182.22 M 487 182.22 L 300.74 185.32 M 294.74 185.42 M 294.74 185.42 L 197.74 187.04 M 191.74 187.14 M 191.74 187.14 L 26.37 189.89" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 21.12 189.98 L 28.06 186.37 L 26.37 189.89 L 28.18 193.36 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 186px; margin-left: 316px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "><div>Redirect 303 to &lt;frontend_url_to_item&gt;/?user_id=&lt;login-module-user-id&gt;, Set-Cookie:  ...<br /></div></div></div></div></foreignObject><text x="316" y="189" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Redirect 303 to &lt;frontend_url_to_item&gt;/?user_id=&lt;login-module-user-id&gt;, Set-Cookie:  ...&#xa;</text></switch></g><ellipse cx="297.5" cy="37.5" rx="37.5" ry="37.5" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 73px; height: 1px; padding-top: 38px; margin-left: 262px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: center"><b>Algorea Frontend</b></div><div align="center">(SPA)<br /></div></div></div></div></foreignObject><text x="262" y="41" fill="#000000" font-family="Helvetica" font-size="12px">Algorea Fron...</text></switch></g><rect x="650" y="130" width="290" height="80" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 137px; margin-left: 652px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><div>if not login-module auth cookie provided OR user <br /></div><div> session's lti_user_id does not match the LTI user_id</div><div> from request:</div><div>    validate LTI launch request</div><div>    auth lti user, create user if not existing<br /></div></div></div></div></foreignObject><text x="652" y="149" fill="#000000" font-family="Helvetica" font-size="12px">if not login-module auth cookie provided OR user...</text></switch></g><rect x="300" y="200" width="320" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 207px; margin-left: 302px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><div>check in local storage that<i> user_id</i> is last encountered user</div></div></div></div></foreignObject><text x="302" y="219" fill="#000000" font-family="Helvetica" font-size="12px">check in local storage that user_id is last encounter...</text></switch></g><path d="M 20 200 L 278.88 205.86" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 284.13 205.97 L 277.05 209.32 L 278.88 205.86 L 277.21 202.32 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 207px; margin-left: 155px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">/?user_id=..</div></div></div></foreignObject><text x="155" y="211" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">/?user_id=..</text></switch></g><rect x="306" y="230" width="644" height="24" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 235px; margin-left: 310px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><b>case 1: user_id is the last known "login_id" (i.e., id from login-module) AND token is still valid:</b> use the last token </div></div></div></foreignObject><text x="310" y="247" fill="#000000" font-family="Helvetica" font-size="12px">case 1: user_id is the last known "login_id" (i.e., id from login-module) AND token is still valid: use the...</text></switch></g><rect x="306" y="254" width="644" height="26" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 259px; margin-left: 310px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; "><b>case 2: otherwise:</b> do "silent auth" (using the login module cookie, not prompting the user) [cfr auth workflow]</div></div></div></foreignObject><text x="310" y="271" fill="#000000" font-family="Helvetica" font-size="12px">case 2: otherwise: do "silent auth" (using the login module cookie, not prompting the user) [cfr auth workf...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>
